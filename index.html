<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IShowSpeed's Travel Stream Map</title>
    <link rel="icon"
        href="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20100%20100'%3E%3Cpath%20fill='%233b82f6'%20d='M50%200C26.8%200%207.5%2019.3%207.5%2042.5c0%2016.1%2011.1%2031.6%2025.8%2042.9%204.7%203.6%209.8%207.1%2016.7%2014.6.1.1.3.2.5.2s.4-.1.5-.2c6.9-7.5%2012-11%2016.7-14.6C81.4%2074.1%2092.5%2058.6%2092.5%2042.5%2092.5%2019.3%2073.2%200%2050%200zm0%2063.8c-11.7%200-21.2-9.5-21.2-21.2S38.3%2021.3%2050%2021.3s21.2%209.5%2021.2%2021.2S61.7%2063.8%2050%2063.8z'/%3E%3C/svg%3E"
        type="image/svg+xml">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
        integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin="" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
        integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
    <script src="https://cdn.jsdelivr.net/npm/luxon@3.4.4/build/global/luxon.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        /* Styles remain the same as before */
        body {
            font-family: 'Inter', sans-serif;
            overscroll-behavior: none;
            margin: 0;
            background-color: #f3f4f6;
        }

        #map {
            height: 75vh;
            width: 100%;
            border-radius: 0.5rem;
            z-index: 1;
            background-color: #e5e7eb;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            cursor: grab;
        }

        #map:active {
            cursor: grabbing;
        }

        .custom-leaflet-tooltip {
            background-color: rgba(255, 255, 255, 0.95) !important;
            border-radius: 0.375rem !important;
            border: 1px solid #e5e7eb !important;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1) !important;
            padding: 0 !important;
            white-space: normal !important;
        }

        .leaflet-tooltip-top::before,
        .leaflet-tooltip-bottom::before,
        .leaflet-tooltip-left::before,
        .leaflet-tooltip-right::before {
            display: none !important;
        }

        .tooltip-content-padding {
            padding: 0.5rem 0.75rem;
        }

        .tooltip-content-padding h3 {
            font-size: 1rem;
            font-weight: 600;
            color: #1f2937;
            margin-bottom: 0.25rem;
        }

        .tooltip-content-padding p {
            font-size: 0.875rem;
            color: #4b5563;
            margin-bottom: 0.25rem;
            line-height: 1.25;
        }

        .tooltip-content-padding strong {
            color: #374151;
        }

        .leaflet-popup-content-wrapper {
            background-color: #ffffff;
            border-radius: 0.5rem;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }

        .leaflet-popup-content {
            margin: 1rem;
            font-size: 0.875rem;
            line-height: 1.4;
            max-height: 250px;
            overflow-y: auto;
            color: #374151;
        }

        .leaflet-popup-content h3 {
            font-size: 1.25rem;
            font-weight: 700;
            color: #111827;
            margin-bottom: 0.75rem;
        }

        .leaflet-popup-content p {
            margin-bottom: 0.5rem;
        }

        .leaflet-popup-content strong {
            font-weight: 600;
            color: #1f2937;
        }

        .leaflet-popup-content a {
            color: #2563eb;
            text-decoration: underline;
            word-break: break-all;
        }

        .leaflet-popup-content a:hover {
            color: #1d4ed8;
        }

        .popup-links-section {
            margin-top: 0.75rem;
            padding-top: 0.5rem;
            border-top: 1px solid #e5e7eb;
        }

        .popup-links-section strong {
            display: block;
            margin-bottom: 0.25rem;
        }

        .popup-links-section a {
            display: block;
            margin-bottom: 0.25rem;
        }

        .leaflet-popup-tip-container {
            display: none;
        }

        .visited-country-base,
        .current-trip-base {
            opacity: 1;
            color: '#ffffff';
            transition: fill-opacity 0.2s ease-in-out, fill-color 0.2s ease-in-out, weight 0.2s ease-in-out;
        }

        .visited-country-base {
            fillOpacity: 0.65;
        }

        .current-trip-base {
            fillOpacity: 0.75;
        }

        .country-flag-icon {
            border: 1px solid #ccc;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);
            border-radius: 2px;
        }

        .leaflet-marker-icon {
            /* May need adjustments */
        }

        .leaflet-marker-shadow {
            /* Usually hidden */
        }

        .extra-content {
            border-top: 1px solid #e5e7eb;
            padding-top: 1rem;
            margin-top: 1rem;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.75rem;
        }

        .extra-content audio {
            max-width: 100%;
            width: 350px;
            height: 40px;
        }

        .readme-button {
            display: inline-flex;
            align-items: center;
            padding: 0.5rem 1rem;
            background-color: #e5e7eb;
            color: #374151;
            font-weight: 500;
            font-size: 0.875rem;
            border-radius: 0.375rem;
            box-shadow: 0 1px 2px 0 rgb(0 0 0 / 0.05);
            text-decoration: none;
            transition: background-color 0.15s ease-in-out;
            cursor: pointer;
        }

        .readme-button:hover {
            background-color: #d1d5db;
            color: #1f2937;
        }

        .readme-button svg {
            width: 1rem;
            height: 1rem;
            margin-right: 0.5rem;
        }

        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            padding: 1rem;
        }

        .modal-content {
            background-color: white;
            padding: 1.5rem 2rem;
            border-radius: 0.5rem;
            max-width: 800px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            position: relative;
            box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
        }

        .modal-close-button {
            position: absolute;
            top: 0.75rem;
            right: 0.75rem;
            background: none;
            border: none;
            font-size: 1.5rem;
            line-height: 1;
            color: #9ca3af;
            cursor: pointer;
        }

        .modal-close-button:hover {
            color: #1f2937;
        }

        .markdown-body h1,
        .markdown-body h2,
        .markdown-body h3 {
            margin-top: 1em;
            margin-bottom: 0.5em;
            font-weight: 600;
            border-bottom: 1px solid #e5e7eb;
            padding-bottom: 0.3em;
        }

        .markdown-body h1 {
            font-size: 1.8em;
        }

        .markdown-body h2 {
            font-size: 1.4em;
        }

        .markdown-body h3 {
            font-size: 1.2em;
        }

        .markdown-body p {
            margin-bottom: 1em;
            line-height: 1.6;
        }

        .markdown-body ul,
        .markdown-body ol {
            margin-left: 2em;
            margin-bottom: 1em;
        }

        .markdown-body li {
            margin-bottom: 0.25em;
        }

        .markdown-body a {
            color: #2563eb;
            text-decoration: underline;
        }

        .markdown-body a:hover {
            color: #1d4ed8;
        }

        .markdown-body code {
            background-color: #f3f4f6;
            padding: 0.2em 0.4em;
            border-radius: 3px;
            font-size: 85%;
        }

        .markdown-body pre {
            background-color: #f3f4f6;
            padding: 1em;
            border-radius: 3px;
            overflow-x: auto;
        }

        .markdown-body pre code {
            padding: 0;
            background-color: transparent;
        }

        .markdown-body blockquote {
            border-left: 4px solid #d1d5db;
            padding-left: 1em;
            color: #6b7280;
            margin-left: 0;
            margin-bottom: 1em;
        }
    </style>
</head>

<body class="p-4 md:p-8">

    <div class="max-w-6xl mx-auto bg-white p-6 rounded-lg shadow-lg mb-8">
        <h1 class="text-2xl md:text-3xl font-bold text-center text-gray-800 mb-6">IShowSpeed's Travel Stream Map</h1>
        <div id="map">
            <p id="map-loading-message" class="text-gray-500 text-center pt-16">Loading map data...</p>
        </div>

        <div class="mt-4 flex flex-wrap justify-center gap-x-4 gap-y-2 text-sm text-gray-600">
            <div class="flex items-center space-x-2">
                <span class="w-4 h-4 rounded border border-gray-300" style="background-color: #3b82f6; opacity: 0.65;" title="Area Highlight"></span>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"
                    class="w-5 h-5 text-gray-500" title="Location Marker">
                    <path fill-rule="evenodd"
                        d="M9.69 18.933l.003.001C9.89 19.02 10 19 10 19s.11.02.308-.066l.002-.001.006-.003.018-.008a5.741 5.741 0 00.281-.14c.186-.096.446-.24.757-.433.62-.384 1.445-.966 2.274-1.765C15.302 14.988 17 12.493 17 9A7 7 0 103 9c0 3.492 1.698 5.988 3.351 7.594.829.799 1.654 1.381 2.274 1.765.31.193.571.337.757.433.097.05.19.095.281.14l.018.008.006.003zM10 11.25a2.25 2.25 0 100-4.5 2.25 2.25 0 000 4.5z"
                        clip-rule="evenodd" />
                </svg> <span>Visited</span>
            </div>
            <div class="flex items-center space-x-2">
                <span class="w-4 h-4 rounded border border-gray-300" style="background-color: #10b981; opacity: 0.75;" title="Area Highlight"></span>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"
                    class="w-5 h-5 text-gray-500" title="Location Marker">
                    <path fill-rule="evenodd"
                        d="M9.69 18.933l.003.001C9.89 19.02 10 19 10 19s.11.02.308-.066l.002-.001.006-.003.018-.008a5.741 5.741 0 00.281-.14c.186-.096.446-.24.757-.433.62-.384 1.445-.966 2.274-1.765C15.302 14.988 17 12.493 17 9A7 7 0 103 9c0 3.492 1.698 5.988 3.351 7.594.829.799 1.654 1.381 2.274 1.765.31.193.571.337.757.433.097.05.19.095.281.14l.018.008.006.003zM10 11.25a2.25 2.25 0 100-4.5 2.25 2.25 0 000 4.5z"
                        clip-rule="evenodd" />
                </svg> <span>Current Trip</span>
            </div>
            <div class="flex items-center space-x-2"> <svg xmlns="http://www.w3.org/2000/svg" fill="none"
                    viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-4 h-4 text-gray-500">
                    <path stroke-linecap="round" stroke-linejoin="round"
                        d="M15.042 21.672 13.684 16.6m0 0-2.51 2.225.569-9.47 5.227 7.917-3.286-.672ZM12 2.25V4.5m5.834.166-1.591 1.591M20.25 10.5H18M7.757 14.743l-1.59 1.59M6 10.5H3.75m4.007-4.243-1.59-1.59" />
                </svg> <span>Click Area/Marker</span> </div>
            <div class="flex items-center space-x-2"> <svg xmlns="http://www.w3.org/2000/svg" fill="none"
                    viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-4 h-4 text-gray-500">
                    <path stroke-linecap="round" stroke-linejoin="round"
                        d="M15.59 14.37a6 6 0 0 1-5.84 7.38v-4.8m5.84-2.58a14.98 14.98 0 0 0 6.16-12.12A14.98 14.98 0 0 0 9.63 2.25a14.98 14.98 0 0 0-1.736 28.13a14.98 14.98 0 0 0 8.81-1.75 1.5 1.5 0 0 0 .356-1.833L15.59 14.37Z" />
                </svg> <span>Hover Area/Marker</span> </div>
        </div>

        <div class="extra-content">
            <button onclick="showReadmeModal()" class="readme-button">
                 <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"></path></svg>
                 About this Map (README)
             </button>
            <div class="mt-2 text-center">
                <p class="text-sm text-gray-600 mb-1">Listen to the Podcast:</p>
                <audio controls class="w-full max-w-sm mx-auto">
                    <source
                        src="__iShowSpeed's Global Glitch_ Unpacking the Chaos, Culture, and Viral Velocity of a Streaming Phenomenon__.wav"
                        type="audio/wav">
                    Your browser does not support the audio element. Try downloading <a
                        href="__iShowSpeed's Global Glitch_ Unpacking the Chaos, Culture, and Viral Velocity of a Streaming Phenomenon__.wav"
                        download class="text-blue-600 hover:underline">here</a>.
                </audio>
            </div>
        </div>
    </div>
    <div id="readme-modal" class="modal-overlay hidden">
        <div class="modal-content"> <button onclick="closeReadmeModal()" class="modal-close-button">×</button>
            <div id="readme-content" class="markdown-body">
                <p class="text-center text-gray-500">Loading README...</p>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // ========================================================================
            // --- CONFIGURATION & DATA ---
            // ========================================================================
            const travelData = [ { country: "United States", iso_a2: "US", date: "2025-04-20", lat: 39.8, lon: -98.6, highlights: "Base of operations (Ohio). Frequent IRL streams across various locations, fan meetups, event participation. Notable events include WrestleMania XL (Philadelphia, Apr 2024), WWE Raw appearance (Apr 2024), Miami streams (Car jump Aug 2024, ComplexCon Nov 2024), Race vs Noah Lyles (Nov 2024), Streamer Awards (Los Angeles, Dec 2024).", links: ["Search YouTube: 'IShowSpeed USA stream'", "Search YouTube: 'IShowSpeed WrestleMania RKO'", "Search YouTube: 'IShowSpeed Streamer Awards 2024'"], current: true }, { country: "Qatar", iso_a2: "QA", date: "2022-11-20", lat: 25.3, lon: 51.2, highlights: "Travelled for the FIFA World Cup 2022 to support Cristiano Ronaldo. Attended matches (including the final), experienced the atmosphere, released 'World Cup' song.", links: ["Search YouTube: 'IShowSpeed Qatar World Cup 2022'", "Search YouTube: 'IShowSpeed World Cup song'"], current: false }, { country: "United Kingdom", iso_a2: "GB", date: "2022-09-24", lat: 51.5, lon: -0.1, highlights: "Participated in Sidemen Charity Matches (London, Sept 2022 & Sept 2023). 2022: Tackled KSI, disallowed goal, whipped referee. 2023: Missed penalty saved by KSI, involved in MrBeast collision.", links: ["Search YouTube: 'IShowSpeed Sidemen Charity Match 2022'", "Search YouTube: 'IShowSpeed Sidemen Charity Match 2023'"], current: false }, { country: "Portugal", iso_a2: "PT", date: "2023-06-17", lat: 38.7, lon: -9.1, highlights: "Fulfilled goal of meeting Cristiano Ronaldo in Lisbon after a Euro qualifier match (vs Bosnia and Herzegovina), facilitated by Rafael Leão. Emotional and widely shared moment.", links: ["Search YouTube: 'IShowSpeed meets Ronaldo Lisbon June 2023'"], current: false }, { country: "Portugal", iso_a2: "PT", date: "2023-07-07", lat: 37.1, lon: -8.5, highlights: "Surprise guest performance at Rolling Loud music festival in Portimão. Performed songs like 'Shake', 'World Cup' with high energy, supported by Ski Mask the Slump God and DJ Scheme.", links: ["Search YouTube: 'IShowSpeed Rolling Loud Portugal 2023'"], current: false }, { country: "India", iso_a2: "IN", date: "2023-10-14", lat: 19.1, lon: 72.9, highlights: "Visited during Cricket World Cup, attended India vs. Pakistan match (Mumbai). Met rapper MC Stan, singer Daler Mehndi (danced to 'Tunak Tunak Tun'), and cricket star Virat Kohli. Explored culture, faced huge crowds.", links: ["Search YouTube: 'IShowSpeed India Cricket World Cup'", "Search YouTube: 'IShowSpeed Daler Mehndi'", "Search YouTube: 'IShowSpeed Virat Kohli'"], current: false }, { country: "Japan", iso_a2: "JP", date: "2023-07-25", lat: 35.7, lon: 139.7, highlights: "Explored Tokyo (Shibuya Crossing, temples, arcades). Experienced culture clashes and stream snipers. Hospitalized (July 28) for severe cluster headaches and sinus infection, requiring parental visit and recovery period.", links: ["Search YouTube: 'IShowSpeed Japan stream Tokyo'", "Search YouTube: 'IShowSpeed Japan hospital'"], current: false }, { country: "Qatar", iso_a2: "QA", date: "2024-02-23", lat: 25.3, lon: 51.2, highlights: "Participated in the 'Match for Hope' charity football game in Doha alongside legends (Kaka, Drogba). Infamously tackled Kaka from behind (yellow card), missed scoring chances. Event raised funds for charity.", links: ["Search YouTube: 'IShowSpeed Match for Hope Kaka tackle'"], current: false }, { country: "South Korea", iso_a2: "KR", date: "2024-05-30", lat: 37.6, lon: 127.0, highlights: "Visited Seoul, generating strong viewership. Met and interacted with K-Pop group Kiss of Life, attempted breakdancing, went on a streamed date, general fan interactions. Faced some streaming restrictions.", links: ["Search YouTube: 'IShowSpeed South Korea Kiss of Life'", "Search YouTube: 'IShowSpeed South Korea stream Seoul'"], current: false }, { country: "United Kingdom", iso_a2: "GB", date: "2024-05-29", lat: 51.8, lon: -2.2, highlights: "Participated in the annual Cooper's Hill Cheese-Rolling event in Gloucestershire. Sustained a leg injury during the chaotic race, reportedly requiring hospitalization.", links: ["Search YouTube: 'IShowSpeed cheese rolling UK injury'"], current: false }, { country: "Germany", iso_a2: "DE", date: "2024-06-16", lat: 51.1, lon: 10.4, highlights: "Based here for UEFA Euro 2024. Attended Portugal matches (vs Czechia, vs France), attempted to meet Ronaldo (blocked by security). Stream rated 'A tier' by Speed.", links: ["Search YouTube: 'IShowSpeed Germany Euro 2024'"], current: false }, { country: "Albania", iso_a2: "AL", date: "2024-06-20", lat: 41.3, lon: 19.8, highlights: "Visited Tirana. Met with Prime Minister Edi Rama, viewed his art, played basketball. Received warm reception from fans. Stream rated 'A tier' by Speed.", links: ["Search YouTube: 'IShowSpeed Albania Prime Minister'"], current: false }, { country: "Italy", iso_a2: "IT", date: "2024-06-22", lat: 41.9, lon: 12.5, highlights: "Visited Venice and Milan. Symbolically 'signed' for AC Milan with Zlatan Ibrahimović in Milan (July). Mistaken for footballer Rafael Leão. Venice stream rated 'B tier' by Speed.", links: ["Search YouTube: 'IShowSpeed Italy Venice'", "Search YouTube: 'IShowSpeed AC Milan Zlatan'"], current: false }, { country: "Netherlands", iso_a2: "NL", date: "2024-06-24", lat: 52.4, lon: 4.9, highlights: "Chaotic stream in Amsterdam. Swarmed by massive crowds, escaped onto a stranger's boat, lost a shoe on Europe's highest swing (later stolen). Stream rated 'F tier' due to chaos.", links: ["Search YouTube: 'IShowSpeed Netherlands Amsterdam chaos'"], current: false }, { country: "Belgium", iso_a2: "BE", date: "2024-06-26", lat: 50.8, lon: 4.4, highlights: "Part of the Euro 2024 tour. Explored and streamed, rated 'A tier' by Speed.", links: ["Search YouTube: 'IShowSpeed Belgium stream Euro 2024'"], current: false }, { country: "Switzerland", iso_a2: "CH", date: "2024-06-28", lat: 46.8, lon: 8.2, highlights: "Visited during the Euro 2024 tour. Stream activities included exploration and fan interactions. Rated 'B tier' by Speed.", links: ["Search YouTube: 'IShowSpeed Switzerland stream Euro 2024'"], current: false }, { country: "Sweden", iso_a2: "SE", date: "2024-07-01", lat: 60.1, lon: 18.6, highlights: "Stop on the Euro 2024 tour. Engaged with fans and explored local areas during the stream. Rated 'A tier' by Speed.", links: ["Search YouTube: 'IShowSpeed Sweden stream Euro 2024'"], current: false }, { country: "Norway", iso_a2: "NO", date: "2024-07-03", lat: 59.9, lon: 10.7, highlights: "Streamed from Oslo. Injured ankle doing 'Siu' celebration for fans. Subsequently mobbed and allegedly attacked by crowd while leaving ('scariest day'), vowed never to return. Stream rated 'F tier'.", links: ["Search YouTube: 'IShowSpeed Norway ankle injury Oslo'", "Search YouTube: 'IShowSpeed Norway attack crowd'"], current: false }, { country: "Poland", iso_a2: "PL", date: "2024-07-07", lat: 50.1, lon: 19.9, highlights: "Hosted '20 Women vs 1 Man: Poland Edition' dating stream in Kraków. Achieved very high viewership (over 309K peak), his highest of 2024 at the time. Stream rated 'S tier'.", links: ["Search YouTube: 'IShowSpeed Poland dating stream Krakow'"], current: false }, { country: "Romania", iso_a2: "RO", date: "2024-07-09", lat: 45.9, lon: 24.9, highlights: "Part of the Euro 2024 tour, visited locations including a waterpark and reportedly a 'dangerous hood'. Stream rated 'S tier' by Speed.", links: ["Search YouTube: 'IShowSpeed Romania stream Euro 2024'"], current: false }, { country: "Hungary", iso_a2: "HU", date: "2024-07-11", lat: 47.1, lon: 19.5, highlights: "Visited during the Euro 2024 tour. Conducted IRL stream with fan interactions. Rated 'B tier' by Speed.", links: ["Search YouTube: 'IShowSpeed Hungary stream Euro 2024'"], current: false }, { country: "Austria", iso_a2: "AT", date: "2024-07-13", lat: 47.5, lon: 14.5, highlights: "Stop on the Euro 2024 tour. Streamed IRL content. Rated 'C tier' by Speed.", links: ["Search YouTube: 'IShowSpeed Austria stream Euro 2024'"], current: false }, { country: "Czechia", iso_a2: "CZ", date: "2024-07-14", lat: 49.8, lon: 15.5, highlights: "Visited during the Euro 2024 tour. Stream featured exploration and fan interactions. Rated 'C tier' by Speed.", links: ["Search YouTube: 'IShowSpeed Czechia stream Euro 2024'"], current: false }, { country: "Bulgaria", iso_a2: "BG", date: "2024-07-16", lat: 42.7, lon: 25.4, highlights: "Part of the Euro 2024 tour. Conducted IRL stream. Rated 'B tier' by Speed.", links: ["Search YouTube: 'IShowSpeed Bulgaria stream Euro 2024'"], current: false }, { country: "Greece", iso_a2: "GR", date: "2024-07-18", lat: 39.1, lon: 21.8, highlights: "Visited during the Euro 2024 tour. Streamed IRL content. Rated 'B tier' by Speed.", links: ["Search YouTube: 'IShowSpeed Greece stream Euro 2024'"], current: false }, { country: "Ireland", iso_a2: "IE", date: "2024-07-20", lat: 53.4, lon: -8.2, highlights: "Stop on the Euro 2024 tour. Streamed IRL content. Rated 'C tier' by Speed.", links: ["Search YouTube: 'IShowSpeed Ireland stream Euro 2024'"], current: false }, { country: "Denmark", iso_a2: "DK", date: "2024-07-22", lat: 56.3, lon: 9.5, highlights: "Final leg of the Euro 2024 tour. Streamed IRL content. Rated 'B tier' by Speed.", links: ["Search YouTube: 'IShowSpeed Denmark stream Euro 2024'"], current: false }, { country: "Thailand", iso_a2: "TH", date: "2024-09-09", lat: 15.9, lon: 101.0, highlights: "Start of Southeast Asia tour. Rode elephants, visited tigers, log wrestling, crashed a tuk-tuk. Initial stream hit high peak viewers (spike possibly disputed).", links: ["Search YouTube: 'IShowSpeed Thailand stream elephants tuktuk'"], current: false }, { country: "Philippines", iso_a2: "PH", date: "2024-09-12", lat: 12.9, lon: 121.8, highlights: "Met and sparred (boxing/chess) with boxing legend Manny Pacquiao. Tried Jollibee, drawing huge crowds. Experienced fan mobs and tech issues. Gained massive subscriber count.", links: ["Search YouTube: 'IShowSpeed Philippines Manny Pacquiao'", "Search YouTube: 'IShowSpeed Jollibee Philippines'"], current: false }, { country: "Vietnam", iso_a2: "VN", date: "2024-09-14", lat: 14.1, lon: 108.3, highlights: "Streamed from Ho Chi Minh City. Tried famous expensive banh mi, interacted with fans.", links: ["Search YouTube: 'IShowSpeed Vietnam stream HCMC banh mi'"], current: false }, { country: "Cambodia", iso_a2: "KH", date: "2024-09-15", lat: 12.5, lon: 104.9, highlights: "Celebrated hitting 30 million YouTube subscribers in Siem Reap amid large crowds. Narrowly avoided injury attempting somersault. Returned later (Sept 25) to Phnom Penh (market, temples, museum), rode motorbike helmetless.", links: ["Search YouTube: 'IShowSpeed Cambodia 30 million subs'", "Search YouTube: 'IShowSpeed Cambodia Phnom Penh stream'"], current: false }, { country: "Malaysia", iso_a2: "MY", date: "2024-09-17", lat: 4.2, lon: 101.9, highlights: "Extremely chaotic visit to Kuala Lumpur. Mobbed by huge crowds, trapped in lift, needed police escort, camera broken. Tried durian/nasi lemak. Visited Uncle Roger's restaurant 'Fuiyoh!' (temporarily shut down due to crowds). Went drifting.", links: ["Search YouTube: 'IShowSpeed Malaysia stream KL chaos'", "Search YouTube: 'IShowSpeed Uncle Roger restaurant Malaysia'"], current: false }, { country: "Indonesia", iso_a2: "ID", date: "2024-09-18", lat: -0.8, lon: 113.9, highlights: "Achieved all-time peak viewership record: 1,043,028 concurrent viewers (Sept 18), becoming #1 English-speaking streamer by peak. Visited a fear room. Encountered Marshmello lookalike (Sept 21). Huge fan engagement.", links: ["Search YouTube: 'IShowSpeed Indonesia record stream 1 million'"], current: false }, { country: "Singapore", iso_a2: "SG", date: "2024-09-24", lat: 1.4, lon: 103.8, highlights: "Initial Universal Studios stream cut short (Sept 22). Returned (Sept 24), won S$10k charity race, gifted iPhone, unusual teh tarik pouring stunt, bad Ronaldo henna tattoo, surfing, attended Gumball 3000. Large crowds required police presence.", links: ["Search YouTube: 'IShowSpeed Singapore stream race teh tarik'", "Search YouTube: 'IShowSpeed Singapore Gumball 3000'"], current: false }, { country: "Australia", iso_a2: "AU", date: "2024-11-22", lat: -25.3, lon: 133.8, highlights: "First visit to Oceania. Trained with GWS Giants (AFL team) in Sydney. Interacted with Socceroos (national football team). Fan meetups and exploration.", links: ["Search YouTube: 'IShowSpeed Australia AFL Giants'", "Search YouTube: 'IShowSpeed Australia Socceroos stream'"], current: false }, { country: "New Zealand", iso_a2: "NZ", date: "2024-11-24", lat: -40.9, lon: 174.9, highlights: "Visited Rotorua (Nov 24): Participated in Haka performance at Māori village, Zorb racing, tried pie. Auckland (Nov 25): Swarmed by fans, trained with Warriors (Rugby League) & Breakers (Basketball), sparred UFC fighter Dan Hooker. Potential visa investigation followed.", links: ["Search YouTube: 'IShowSpeed New Zealand Haka Rotorua'", "Search YouTube: 'IShowSpeed New Zealand Auckland chaos Dan Hooker'"], current: false }, { country: "Colombia", iso_a2: "CO", date: "2025-01-12", lat: 4.6, lon: -74.3, highlights: "First stop of South America tour. Enjoyed local food, received positive fan reception, gained subs.", links: ["Search YouTube: 'IShowSpeed Colombia stream January 2025'"], current: false }, { country: "Ecuador", iso_a2: "EC", date: "2025-01-16", lat: -1.8, lon: -78.2, highlights: "Part of South America tour. Rode a large swing attraction, interacted with fans. Rated 'S tier' potential by Speed.", links: ["Search YouTube: 'IShowSpeed Ecuador stream swing'"], current: false }, { country: "Panama", iso_a2: "PA", date: "2025-01-18", lat: 8.5, lon: -80.8, highlights: "Met Mayor Mayer Mizrachi, jokingly declared 'Mayor of Panama'. Attempted Panama Canal visit but faced restrictions.", links: ["Search YouTube: 'IShowSpeed Panama Mayor Mizrachi'"], current: false }, { country: "Guatemala", iso_a2: "GT", date: "2025-01-20", lat: 15.8, lon: -90.2, highlights: "Part of South America tour. Tried local tortilla chips, had large motorbike escort. Planned helicopter trip to volcano cancelled. Rated 'A tier' potential.", links: ["Search YouTube: 'IShowSpeed Guatemala stream motorbike'"], current: false }, { country: "Argentina", iso_a2: "AR", date: "2025-01-21", lat: -34.6, lon: -63.6, highlights: "Celebrated 20th birthday in Buenos Aires. Received Instagram shout-out from Cristiano Ronaldo. Cruised with bikers, encountered Messi/Maradona fans. High peak viewership.", links: ["Search YouTube: 'IShowSpeed Argentina birthday stream Ronaldo'"], current: false }, { country: "Chile", iso_a2: "CL", date: "2025-01-23", lat: -35.7, lon: -71.5, highlights: "Visited amusement park, joined a local carnival. High peak viewership. Rated 'S tier' by Speed.", links: ["Search YouTube: 'IShowSpeed Chile stream carnival'"], current: false }, { country: "Uruguay", iso_a2: "UY", date: "2025-01-25", lat: -32.5, lon: -55.8, highlights: "Part of South America tour. Fan interactions documented. Rated 'A tier' potential if more activities were done.", links: ["Search YouTube: 'IShowSpeed Uruguay stream January 2025'"], current: false }, { country: "Paraguay", iso_a2: "PY", date: "2025-01-27", lat: -23.4, lon: -58.4, highlights: "Stream plagued by significant technical issues and poor internet. Visited the border area near Iguazu Falls.", links: ["Search YouTube: 'IShowSpeed Paraguay stream technical issues'"], current: false }, { country: "Brazil", iso_a2: "BR", date: "2025-01-27", lat: -25.5, lon: -54.6, highlights: "Brief visit during South America tour focused on Iguazu Falls (border region with Paraguay/Argentina). Fan interactions, abrupt stream end. Rated 'C tier' for this specific visit.", links: ["Search YouTube: 'IShowSpeed Brazil Iguazu Falls Jan 2025'"], current: false }, { country: "Brazil", iso_a2: "BR", date: "2024-02-15", lat: -22.9, lon: -43.2, highlights: "(Previous Trip) Experienced Rio de Janeiro Carnival, visited Christ the Redeemer, explored favelas (guided), met Brazilian legend Ronaldo Nazário. High energy, dancing, fan interactions.", links: ["Search YouTube: 'IShowSpeed Brazil stream Rio Carnival'", "Search YouTube: 'IShowSpeed meets Ronaldo Nazario'"], current: false }, { country: "Peru", iso_a2: "PE", date: "2025-01-28", lat: -9.2, lon: -75.0, highlights: "Met Lima Mayor Rafael López Aliaga, formally declared honorary 'Mayor of Lima' for 1 hour with ceremony. Gave speech from balcony. Received police escort, forced rapid departure due to massive fan chase. Highest peak viewership of SA tour (487K+). Tried local foods (ceviche, cuy).", links: ["Search YouTube: 'IShowSpeed Peru Mayor Lima fan chase'"], current: false }, { country: "Bolivia", iso_a2: "BO", date: "2025-01-29", lat: -16.3, lon: -63.6, highlights: "Likely final stop of South America tour. Danced with locals, dealt with crowd issues and theft attempts.", links: ["Search YouTube: 'IShowSpeed Bolivia stream dance'"], current: false }, { country: "China", iso_a2: "CN", date: "2025-03-24", lat: 35.9, lon: 104.2, highlights: "Extensive tour across mainland China (Beijing, Shanghai, Chengdu, Shenzhen, Changsha). Scaled Great Wall, visited Forbidden City, explored Bund, sampled food (panda stream restricted), saw tech hub (robots, drones, flying car - Shenzhen peak viewers), met singer Da Zang Wei, trained with Shaolin monks, met 'Chinese Trump' Tony LC Sign, got $1 haircut, blind date stream. Seen as 'cultural bridge'.", links: ["Search YouTube: 'IShowSpeed China Great Wall Beijing'", "Search YouTube: 'IShowSpeed China Shenzhen flying car'", "Search YouTube: 'IShowSpeed Shaolin Monks China'"], current: false }, { country: "Hong Kong", iso_a2: "HK", date: "2025-04-04", lat: 22.3, lon: 114.1, highlights: "Reached 38 million subscribers during the stream. Showcased skyline views, interacted with fans on a boat/yacht, explored the city.", links: ["Search YouTube: 'IShowSpeed Hong Kong stream 38 million'"], current: false }, { country: "Mongolia", iso_a2: "MN", date: "2025-04-11", lat: 46.8, lon: 103.8, highlights: "Part of East Asia tour. Conducted IRL stream exploring Ulaanbaatar. Joined and performed with a local Mongolian band.", links: ["Search YouTube: 'IShowSpeed Mongolia stream band'"], current: false } ];
            // ========================================================================

            // --- Map & Layer Initialization ---
            const mapElement = document.getElementById('map');
            const loadingMessage = document.getElementById('map-loading-message');
            if (!mapElement) { console.error("Map container element '#map' not found!"); return; }
            if (mapElement.offsetHeight === 0 || mapElement.offsetWidth === 0) { console.warn("Map container has zero height or width."); }
            let map, geoJsonLayer, markers;
            try {
                map = L.map('map', { worldCopyJump: true }).setView([20, 0], 2);
                L.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png', { maxZoom: 18, attribution: '© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors © <a href="https://carto.com/attributions">CARTO</a>' }).addTo(map);
                markers = L.featureGroup().addTo(map);
            } catch (initError) { console.error("Leaflet map initialization failed:", initError); if (mapElement) mapElement.innerHTML = `<p class="text-red-600 text-center p-4">Could not initialize the map. ${initError.message}</p>`; return; }

            // --- Data Processing ---
            const visitedCountryData = travelData.reduce((acc, trip) => { acc[trip.iso_a2] = trip; return acc; }, {});
            const now = luxon.DateTime.now();

            // --- Helper Functions ---
            function timeAgo(isoDateString) { const pastDate = luxon.DateTime.fromISO(isoDateString); return pastDate.isValid ? pastDate.toRelative({ base: now }) : "Unknown date"; }
            function getYouTubeSearchUrl(query) { return `https://www.youtube.com/results?search_query=${encodeURIComponent(query)}`; }

            // --- Styling ---
            function styleCountry(feature) { const countryCode = feature.properties.iso_a2; if (countryCode && visitedCountryData[countryCode]) { const tripData = visitedCountryData[countryCode]; return { fillColor: tripData.current ? '#10b981' : '#3b82f6', weight: tripData.current ? 2 : 1, opacity: 1, color: '#ffffff', fillOpacity: tripData.current ? 0.75 : 0.65, className: tripData.current ? 'current-trip-base' : 'visited-country-base' }; } else { return { fillColor: '#cccccc', fillOpacity: 0.1, weight: 0.5, color: '#e5e7eb' }; } }
            function getHoverStyle(tripData) { return { weight: 2, color: '#ffffff', fillOpacity: 0.85, fillColor: tripData.current ? '#059669' : '#2563eb' }; }

            // --- Event Handlers ---
            function handleAreaMouseover(e) { const layer = e.target; const countryCode = layer.feature.properties.iso_a2; if (countryCode && visitedCountryData[countryCode]) { layer.setStyle(getHoverStyle(visitedCountryData[countryCode])); if (!L.Browser.ie && !L.Browser.opera && !L.Browser.edge) { layer.bringToFront(); } layer.openTooltip(); } }
            function handleAreaMouseout(e) { const layer = e.target; if (geoJsonLayer && layer.feature && visitedCountryData[layer.feature.properties.iso_a2]) { geoJsonLayer.resetStyle(layer); } layer.closeTooltip(); }
            function handleMarkerMouseover(e) { const marker = e.target; const areaLayer = marker.options.areaLayer; if (areaLayer && areaLayer.feature && visitedCountryData[areaLayer.feature.properties.iso_a2]) { areaLayer.setStyle(getHoverStyle(visitedCountryData[areaLayer.feature.properties.iso_a2])); if (!L.Browser.ie && !L.Browser.opera && !L.Browser.edge) { areaLayer.bringToFront(); } areaLayer.openTooltip(marker.getLatLng()); } }
            function handleMarkerMouseout(e) { const marker = e.target; const areaLayer = marker.options.areaLayer; if (areaLayer && geoJsonLayer && areaLayer.feature && visitedCountryData[areaLayer.feature.properties.iso_a2]) { geoJsonLayer.resetStyle(areaLayer); areaLayer.closeTooltip(); } }
            function showDetailsPopup(e) {
                let countryCode, latlng, targetLayer;
                if (e.target.feature) { // Clicked on Area
                    targetLayer = e.target;
                    countryCode = targetLayer.feature.properties.iso_a2;
                    latlng = e.latlng;
                } else if (e.target.options && e.target.options.countryCode) { // Clicked on Marker
                    targetLayer = e.target.options.areaLayer; // Get the associated area layer
                    countryCode = e.target.options.countryCode;
                    latlng = e.target.getLatLng();
                } else { return; } // Unknown target

                if (countryCode && visitedCountryData[countryCode]) {
                    const tripData = visitedCountryData[countryCode];
                    const pastDate = luxon.DateTime.fromISO(tripData.date); // Parse once
                    const ago = pastDate.isValid ? pastDate.toRelative({ base: now }) : "Unknown date";
                    const formattedDate = pastDate.isValid ? `${pastDate.monthLong} ${pastDate.year}` : 'N/A'; // Use Month Year format

                    let popupContent = `<h3>${tripData.country}</h3> <p><strong>Visited:</strong> ${ago} (around ${formattedDate})</p> <p><strong>Highlights:</strong> ${tripData.highlights}</p>`;
                    if (tripData.links && tripData.links.length > 0) { popupContent += '<div class="popup-links-section"><strong>Related Links:</strong>'; tripData.links.forEach(linkText => { linkText = linkText.trim(); let url = '#'; let linkDisplay = linkText; if (linkText.toLowerCase().startsWith('http://') || linkText.toLowerCase().startsWith('https://')) { url = linkText; try { const urlObj = new URL(linkText); linkDisplay = urlObj.hostname.includes('youtube.com') || urlObj.hostname.includes('youtu.be') ? 'Watch on YouTube' : urlObj.hostname; } catch (err) { linkDisplay = 'Direct Link'; } } else if (linkText.toLowerCase().startsWith('search youtube:')) { const query = linkText.substring("Search YouTube:".length).trim(); if (query) { url = getYouTubeSearchUrl(query); linkDisplay = `Search: "${query}"`; } else { linkDisplay = ''; } } else { linkDisplay = ''; } if (linkDisplay && url !== '#') { popupContent += `<a href="${url}" target="_blank" rel="noopener noreferrer">${linkDisplay}</a>`; } }); popupContent += '</div>'; }
                    L.popup({ maxWidth: 350, autoPan: true, autoPanPadding: L.point(50, 50), closeButton: true }).setLatLng(latlng).setContent(popupContent).openOn(map);
                    if (targetLayer && typeof targetLayer.getBounds === 'function') { map.flyToBounds(targetLayer.getBounds(), { paddingTopLeft: L.point(0, 10), paddingBottomRight: L.point(0, 10), duration: 0.5 }); }
                }
            }

            // ========================================================================
            // --- FEATURE PROCESSING & MODAL FUNCTIONS ---
            // ========================================================================

            /** Processes each GeoJSON feature layer: adds tooltips, markers, and events. */
            function processFeatureLayer(layer) {
                if (!layer || !layer.feature || !layer.feature.properties) { console.warn("Skipping feature processing due to unexpected layer structure:", layer); return; }
                const countryCode = layer.feature.properties.iso_a2;
                const featureName = layer.feature.properties.name || countryCode || 'unknown feature';
                try {
                    if (countryCode && visitedCountryData[countryCode]) {
                        const tripData = visitedCountryData[countryCode];
                        const ago = timeAgo(tripData.date);
                        const highlightsSnippet = tripData.highlights.length > 120 ? tripData.highlights.substring(0, 120) + '...' : tripData.highlights;
                        let tooltipContent = `<div class="tooltip-content-padding"><h3>${tripData.country}</h3><p><strong>Visited:</strong> ${ago}</p><p><strong>Highlights:</strong> ${highlightsSnippet}</p></div>`;
                        layer.bindTooltip(tooltipContent, { sticky: true, direction: 'auto', offset: L.point(10, 0), className: 'custom-leaflet-tooltip' });
                        if (tripData.lat !== undefined && tripData.lon !== undefined) {
                            const flagUrl = `https://flagcdn.com/w40/${countryCode.toLowerCase()}.png`;
                            const flagIcon = L.icon({ iconUrl: flagUrl, iconSize: [32, 24], iconAnchor: [16, 12], popupAnchor: [0, -12], className: 'country-flag-icon' });
                            const marker = L.marker([tripData.lat, tripData.lon], { icon: flagIcon, countryCode: countryCode, areaLayer: layer }).addTo(markers);
                            marker.on({ click: showDetailsPopup, mouseover: handleMarkerMouseover, mouseout: handleMarkerMouseout });
                        } else { console.warn(`Missing lat/lon for visited country: ${featureName}. Skipping marker.`); }
                    }
                    layer.on({ mouseover: handleAreaMouseover, mouseout: handleAreaMouseout, click: showDetailsPopup });
                } catch (featureError) { console.error(`Error processing feature ${featureName}:`, featureError); console.dir(featureError); }
            }

            /** Fetches and displays the README.md content in a modal. */
            function showReadmeModal() {
                const modal = document.getElementById('readme-modal');
                const contentDiv = document.getElementById('readme-content');
                if (!modal || !contentDiv) { console.error("Modal elements not found!"); return; }
                contentDiv.innerHTML = '<p class="text-center text-gray-500">Loading README...</p>';
                modal.classList.remove('hidden'); modal.classList.add('flex');
                fetch('research.md')
                    .then(response => { if (!response.ok) { throw new Error(`HTTP error! status: ${response.status}`); } return response.text(); })
                    .then(markdownText => { if (window.marked) { contentDiv.innerHTML = marked.parse(markdownText); } else { console.error("marked.js library not loaded."); contentDiv.innerHTML = '<p class="text-red-600">Error: Could not load Markdown parser.</p>'; } })
                    .catch(error => { console.error('Error fetching or parsing research.md:', error); contentDiv.innerHTML = `<p class="text-red-600 text-center">Error loading research.md: ${error.message}</p>`; });
            }

            /** Hides the README modal. */
            function closeReadmeModal() {
                const modal = document.getElementById('readme-modal');
                if (modal) { modal.classList.add('hidden'); modal.classList.remove('flex'); }
            }

            // Make modal functions globally accessible
            window.showReadmeModal = showReadmeModal;
            window.closeReadmeModal = closeReadmeModal;

            // ========================================================================
            // --- DATA LOADING & MAP POPULATION ---
            // ========================================================================
            const geoJsonUrl = 'https://d2ad6b4ur7yvpq.cloudfront.net/naturalearth-3.3.0/ne_50m_admin_0_countries.geojson';
            fetch(geoJsonUrl)
                .then(response => { if (!response.ok) { throw new Error(`HTTP error! status: ${response.status} ${response.statusText || '(No status text)'}`); } return response.json(); })
                .then(data => {
                    if (!map) { console.error("Map object not initialized before adding GeoJSON layer."); return; }
                    if (loadingMessage) loadingMessage.style.display = 'none';
                    try {
                        geoJsonLayer = L.geoJson(data, { style: styleCountry }).addTo(map);
                    } catch (layerCreationError) { console.error("Error creating initial GeoJSON layer:", layerCreationError); console.dir(layerCreationError); if (mapElement) mapElement.innerHTML = `<p class="text-red-600 text-center p-4">Error creating map layers: ${layerCreationError.message || 'Unknown layer creation error'}</p>`; return; }
                    try {
                         setTimeout(() => {
                             console.log("Starting to add interactions and markers...");
                             if (geoJsonLayer && typeof geoJsonLayer.eachLayer === 'function') { geoJsonLayer.eachLayer(processFeatureLayer); markers.bringToFront(); console.log("Finished adding interactions and markers."); }
                             else { console.error("geoJsonLayer is not valid or doesn't have eachLayer method."); }
                         }, 50);
                    } catch (interactionError) {
                         console.error("Error initiating interactions/markers processing:", interactionError); console.dir(interactionError);
                         if (mapElement) { const errorDiv = document.createElement('p'); errorDiv.className = 'text-orange-600 text-center p-2 text-sm'; errorDiv.textContent = `Note: Some map interactions might be missing due to errors (${interactionError.message || 'Unknown interaction error'}).`; mapElement.parentNode.insertBefore(errorDiv, mapElement.nextSibling); }
                    }
                })
                .catch(error => {
                    console.error("Error loading or processing GeoJSON. Details:", error); console.dir(error);
                    if (mapElement) mapElement.innerHTML = `<p class="text-red-600 text-center p-4">Could not load map data: ${error.message || 'Unknown error'}. Please check the browser console for details or try again later.</p>`;
                    if (loadingMessage) loadingMessage.style.display = 'none'; if (mapElement) mapElement.style.height = 'auto';
                });

        }); // --- End of DOMContentLoaded listener ---
    </script>

</body>

</html>
